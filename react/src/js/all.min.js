function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(){function e(){var e=r.outerHeight(!0);a.height(e),t.css({"padding-bottom":e,"padding-top":s.outerHeight(!0)})}var t=$("body"),s=$("#navbar"),a=$("#page-footer"),r=$("#page-footer-content"),o=_.throttle(function(){e()},250);e(),$(window).resize(o)}();var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,s,a){return s&&e(t.prototype,s),a&&e(t,a),t}}(),Timeline=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={test:!1},e._getData(),e}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){$("body").removeClass("loading")}},{key:"componentDidUpdate",value:function(){this.state.initialized&&this._alternateFloats()}},{key:"_getData",value:function(){function e(e){var t,s,a;return t=e.replace(/,/g,"").split("/"),a={year:2e3+100*Number(t[0])+Number(t[1].substring(0,2))},t[1].length>2&&(s=t[1].split(".")),a.century=t[0],a.month=s[0].substring(2,4),a.date=s[1]||"00",a.month="00"===a.month?"01":a.month,a.date="00"===a.date?"01":a.date,a}var t=this,s=[],a={UFP:{path:"assets/js/data/UFP.json",id:"oesera6",hasFull:!1,show:!0,showFull:!0,name:"United Federation of Planets"},KLE:{path:"assets/js/data/KLE.json",id:"o15noc3",hasFull:!0,show:!0,showFull:!1,name:"Klingon Empire"},RSA:{path:"assets/js/data/RSA.json",id:"or7u0kt",hasFull:!0,show:!0,showFull:!1,name:"Romulan Star Empire"},TRI:{path:"assets/js/data/TRI.json",id:"ol08r1n",hasFull:!1,show:!0,showFull:!0,name:"Triangle"},ORC:{path:"assets/js/data/ORC.json",id:"ohu3d91",hasFull:!0,show:!0,showFull:!1,name:"Orion Colonies"},RFW:{path:"assets/js/data/RFW.json",id:"oypmvfb",hasFull:!1,show:!0,showFull:!0,name:"Romulan/Federation War"},FYW:{path:"assets/js/data/FYW.json",id:"oi1ju2s",hasFull:!1,show:!0,showFull:!0,name:"Four Years War"},ST3:{path:"assets/js/data/ST3.json",id:"o5oxeec",hasFull:!1,show:!0,showFull:!0,name:"Star Trek 3 Update"},ST4:{path:"assets/js/data/ST4.json",id:"oxxpvso",hasFull:!1,show:!0,showFull:!0,name:"Star Trek 4 Update"},SFI:{path:"assets/js/data/SFI.json",id:"ohqn30t",hasFull:!1,show:!0,showFull:!0,name:"Starfleet Intelligence"},ITA:{path:"assets/js/data/ITA.json",id:"orojt89",hasFull:!1,show:!0,showFull:!0,name:"UFP/Independent Traders' Association"}},r={sources:{},entries:[]};$.each(a,function(t,a){a.dfd=$.Deferred(),s.push(a.dfd),$.ajax({url:a.path,dataType:"json"}).success(function(s){r.sources[t]={name:a.name,hasFull:a.hasFull,show:a.show,showFull:a.showFull};for(var o=0;o<s.feed.entry.length;o++){var l=e(s.feed.entry[o].gsx$stardate.$t);r.entries.push({inverted:!1,stardate:s.feed.entry[o].gsx$stardate.$t,sortkey:Number(l.year+"."+l.month+l.date),end:s.feed.entry[o].gsx$stardateend.$t||null,century:l.century,year:l.year,month:l.month,date:l.date,source:s.feed.title.$t,full:"TRUE"===s.feed.entry[o].gsx$full.$t,desc:s.feed.entry[o].gsx$event.$t})}a.dfd.resolve()})}),$.when.apply(null,s).done(function(){r.entries=_.sortBy(r.entries,"sortkey"),r.initialized=!0,r.parentClasses=t._getParentClasses(r.sources),t.setState(r),t._alternateFloats(),t._addListeners()})}},{key:"_addListeners",value:function(){function e(){var e=r.val();if(""!==e)if(NaN===Number(e))r.val("");else{var a=null,o=s.outerHeight(!0);$(".tl-entry:visible").each(function(t){var s=$(this).data("century");if(s>=e)return a=o+$(this).position().top,!1}),null!==a&&(t(a),r.val(""))}}function t(e){$("html,body").stop().animate({scrollTop:e},1e3)}var s=$("#page-header"),a=$("#page-footer"),r=$("#century-search");$("body").on("click",function(s){$(s.target);switch(s.target.id){case"navbar-brand":window.scroll(0,0);break;case"btn-return-top":t(0);break;case"btn-footer":t(a.position().top);break;case"btn-search":e()}}),r.on("keypress",function(t){"13"==t.which&&(t.preventDefault(),e())})}},{key:"_getEntries",value:function(){var e=this,t=0;return this.state.entries.map(function(s){s.key=t;var a=e.state.sources[s.source],r=!(!a.show||s.full!==a.showFull),o=React.createElement(TLEntry,{obj:s,name:a.name,show:r,key:t});return t++,o})}},{key:"_updateSource",value:function(e,t){var s=this,a=_.clone(s.state.sources),r="";void 0!==t?a[e].showFull=!a[e].showFull:a[e].show=!a[e].show,r=s._getParentClasses(a),s.setState({sources:a,parentClasses:r})}},{key:"_getParentClasses",value:function(e){var t=[],s=(_.map(e,function(e,s){e.show===!0&&t.push(s),e.hasFull===!0&&e.showFull===!0&&t.push(s+"-full")}),t.toString().replace(/,/g," "));return s}},{key:"_alternateFloats",value:function(){$(".tl-entry:visible").each(function(e){(e+1)%2===0?$(this).addClass("tl-inverted"):$(this).removeClass("tl-inverted")})}},{key:"render",value:function(){var e=null;if(this.state.initialized){var t=this._getEntries();e=React.createElement("div",{id:"timeline"},React.createElement(TLToggles,{sources:this.state.sources,updateSource:this._updateSource.bind(this)}),React.createElement("ul",{id:"tl-list",className:"tl-list "+this.state.parentClasses},t))}else e=React.createElement("div",{className:"page-load text-center"},React.createElement("div",{id:"page-load-spinner",className:"page-load-spinner"},React.createElement("span",{className:"glyphicon glyphicon-repeat trans-spin","aria-hidden":"true"})),React.createElement("p",null,"Loading Timeline Events..."));return e}}]),t}(React.Component),ButtonGroup=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"_handleToggle",value:function(){this.props.updateSource(this.props.source)}},{key:"_handleFull",value:function(){this.props.updateSource(this.props.source,this.props.showFull)}},{key:"render",value:function(){var e=this.props.show?" active":"",t=this.props.showFull?" active":"",s=void 0;return this.props.hasFull&&(s=React.createElement("button",{onClick:this._handleFull.bind(this),id:this.props.source+"-full",type:"button",className:"btn btn-"+this.props.type+" btn-lg "+this.props.source+t},"Full")),React.createElement("div",{className:"btn-group",role:"group","aria-label":this.props.source},React.createElement("button",{onClick:this._handleToggle.bind(this),id:this.props.source+"-toggle",type:"button",className:"btn btn-"+this.props.type+" btn-lg "+this.props.source+e},this.props.source),s)}}]),t}(React.Component),TLToggles=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"tl-toggles",className:"source-toggles"},React.createElement("div",{className:"panel panel-primary"},React.createElement("div",{className:"panel-body bg-info"},React.createElement("p",null,"Major Governments"),React.createElement("div",{id:"source-toolbar",className:"btn-toolbar",role:"toolbar","aria-label":"Toolbar with button groups"},React.createElement(ButtonGroup,{source:"UFP",type:"primary",hasFull:this.props.sources.UFP.hasFull,show:this.props.sources.UFP.show,showFull:this.props.sources.UFP.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"KLE",type:"primary",hasFull:this.props.sources.KLE.hasFull,show:this.props.sources.KLE.show,showFull:this.props.sources.KLE.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"RSA",type:"primary",hasFull:this.props.sources.RSA.hasFull,show:this.props.sources.RSA.show,showFull:this.props.sources.RSA.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"ORC",type:"primary",hasFull:this.props.sources.ORC.hasFull,show:this.props.sources.ORC.show,showFull:this.props.sources.ORC.showFull,updateSource:this.props.updateSource})),React.createElement("div",null,React.createElement("span",{className:"label label-primary"},"UFP: "+this.props.sources.UFP.name),React.createElement("span",{className:"label label-primary"},"KLE: "+this.props.sources.KLE.name),React.createElement("span",{className:"label label-primary"},"RSA: "+this.props.sources.RSA.name),React.createElement("span",{className:"label label-primary"},"ORC: "+this.props.sources.ORC.name)))),React.createElement("div",{className:"panel panel-warning"},React.createElement("div",{className:"panel-body bg-warning"},React.createElement("p",null,"Misc"),React.createElement("div",{id:"source-toolbar",className:"btn-toolbar",role:"toolbar","aria-label":"Toolbar with button groups"},React.createElement(ButtonGroup,{source:"TRI",type:"warning",hasFull:this.props.sources.TRI.hasFull,show:this.props.sources.TRI.show,showFull:this.props.sources.TRI.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"SFI",type:"warning",hasFull:this.props.sources.SFI.hasFull,show:this.props.sources.SFI.show,showFull:this.props.sources.SFI.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"ITA",type:"warning",hasFull:this.props.sources.ITA.hasFull,show:this.props.sources.ITA.show,showFull:this.props.sources.ITA.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"ST3",type:"warning",hasFull:this.props.sources.ST3.hasFull,show:this.props.sources.ST3.show,showFull:this.props.sources.ST3.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"ST4",type:"warning",hasFull:this.props.sources.ST4.hasFull,show:this.props.sources.ST4.show,showFull:this.props.sources.ST4.showFull,updateSource:this.props.updateSource})),React.createElement("div",null,React.createElement("span",{className:"label label-warning"},"TRI: "+this.props.sources.TRI.name),React.createElement("span",{className:"label label-warning"},"SFI: "+this.props.sources.SFI.name),React.createElement("span",{className:"label label-warning"},"ITA: "+this.props.sources.ITA.name),React.createElement("span",{className:"label label-warning"},"ST3: "+this.props.sources.ST3.name),React.createElement("span",{className:"label label-warning"},"ST4: "+this.props.sources.ST4.name)))),React.createElement("div",{className:"panel panel-danger"},React.createElement("div",{className:"panel-body bg-danger"},React.createElement("p",null,"Wars"),React.createElement("div",{id:"source-toolbar",className:"btn-toolbar",role:"toolbar","aria-label":"Toolbar with button groups"},React.createElement(ButtonGroup,{source:"RFW",type:"danger",hasFull:this.props.sources.RFW.hasFull,show:this.props.sources.RFW.show,showFull:this.props.sources.RFW.showFull,updateSource:this.props.updateSource}),React.createElement(ButtonGroup,{source:"FYW",type:"danger",hasFull:this.props.sources.FYW.hasFull,show:this.props.sources.FYW.show,showFull:this.props.sources.FYW.showFull,updateSource:this.props.updateSource})),React.createElement("div",null,React.createElement("span",{className:"label label-danger"},"RFW: "+this.props.sources.RFW.name),React.createElement("span",{className:"label label-danger"},"FYW: "+this.props.sources.FYW.name)))))}}]),t}(React.Component),TLEntry=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.obj;return React.createElement("li",{id:"tl-entry-"+e.key,className:"tl-entry "+e.source+" tl-full-"+e.full,"data-century":e.century},React.createElement("div",{className:"tl-badge"}),React.createElement("div",{className:"tl-panel"},React.createElement("div",{className:"tl-heading"},React.createElement("h4",{className:"tl-title"},e.stardate),React.createElement("p",null,React.createElement("small",{className:"tl-subtext text-muted"},React.createElement("i",{className:"glyphicon glyphicon-folder-open"}),this.props.name))),React.createElement("div",{className:"tl-body"},e.desc)))}}]),t}(React.Component);ReactDOM.render(React.createElement(Timeline,null),document.getElementById("timeline-app"));